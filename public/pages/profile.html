<link rel="stylesheet" type="text/css" href="/stylesheets/profile.css">
<div id="profile-main" class="container-fluid" ng-controller="profileController">
<!--<script type="text/javascript">
	$(document).ready(function(){
	var scope = angular.element($("#profile-main")).scope()
	scope.$apply(function() {
		scope.setUser('{{username}}')
	})})
	</script>-->
	<div class="row">
		<div class="col-md-4 col-md-offset-4">
			<div id="profile-image-holder">
				<img id="profile-img" ng-src="{{user.imageurl}}"/>
			</div>
		</div>
	</div>
	<div class="row">
		<div id="below-image" class="col-md-12">
			<h2 id="username" ng-bind="user.username"></h2>
			<h4 id="email" ng-bind="user.email"></h2>
		</div>
	</div>
	<div class="row">
		<div class="col-md-4 col-md-offset-4">
			<p id="description" ng-bind="user.description" ng-show="!editing"></p>
			<textarea id="description-box" placeholder="Description" style="width:100%" ng-if="editing" ng-model="edits.newDescription">{{user.description}}</textarea>
		</div>
	</div>
	<div class="row" ng-if="hasEditPermission">
		<div id="buttons" class="col-md-2 col-md-offset-5" style="text-align: center;">
			<button id="edit-button" class="btn btn-primary" ng-click="enterEditMode()" ng-if="!editing">Edit</button>
			<button id="save-button" class='btn btn-success' ng-click='saveEdits()' ng-if="editing">Save Changes</button>
			<button id="change-password-button" class='btn btn-primary' data-toggle="modal" data-target="#password-modal" ng-if="editing">Change Password</button>
			<button id="change-image-button" class='btn btn-primary' ng-click='test()' ng-if="editing">Upload Profile Image</button>
		</div>
	</div>
	<div class="row">
		<div class="col-md-3">
			<h2 style="text-align:center">Groups</h2>

			<div class="group" ng-repeat="group in groups" ng-group>
				<div class="well">
					<div class="group-top row">
						<div class="col-md-9 group-left">
							<h3 class="center">{{group.name}}</h3>
						</div>
						<div class="col-md-3 group-right">
							<span class="fa fa-users group-icon"></span>
						</div>
					</div>
					<div class="group-description row">
						<h4>{{group.description}}</h4>
					</div>
				</div>
			</div>

			<div ng-if="isEmpty(groups)" class="well">
				<i><h3 class="center">No Groups Listed</h3></i>
			</div>
		</div>
		<div class="col-md-6">
			<h2 style="text-align:center">Posts</h2>

			<div class="post" ng-repeat="post in posts">
				<div class="well">
					<h4>{{post.text}}</h4>
				</div>
			</div>

			<div ng-if="isEmpty(posts)" class="well">
				<i><h3 class="center">No Posts Listed</h3></i>
			</div>
		</div>
		<div id="interests" class="col-md-3">
			<h2 style="text-align:center">Interests</h2>

			<div class="interest" ng-repeat="int in user.interests">
				<div class="well row">
					<div class="col-md-3">
						<span class="glyphicon glyphicon-star interest-star" aria-hidden="true"></span>
					</div>
					<div class="col-md-9">
						<h3>&nbsp;{{int.name}}</h3>
					</div>
				</div>
			</div>

			<div ng-if="isEmpty(user.interests)" class="well">
				<i><h3 class="center">No Interests Listed</h3></i>
			</div>
		</div>
	</div>
</div>

<div id="password-modal" class="modal" tabindex="-1" role="dialog" ng-controller="profilePasswordController">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Change Password</h4>
			</div>

			<div class="modal-body">
				<span id="password-error" class="error" ng-show="error">{{error}}</span>
				<div style="width: 100%">
					<div class="input-group">
						<input type="password" class="form-control" style="width: 100%" placeholder="Old Password" ng-model="passwordChange.old" ng-change="resetError()">
					</div>
					<div class="input-group">
						<input type="password" class="form-control" style="width: 100%" placeholder="New Password" ng-model="passwordChange.new1" ng-change="resetError()">
					</div>
					<div class="input-group">
						<input type="password" class="form-control" style="width: 100%" placeholder="Confirm Password" ng-model="passwordChange.new2" ng-change="resetError()">
					</div>
				</div>
			</div>

			<div class="modal-footer">
				<button class="btn btn-default" data-dismiss="modal">Close</button>
				<button class="btn btn-success" ng-click="changePassword()">Save Changes</button>
			</div>
		</div>
	</div>
</div>